

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Requirements for Input &mdash; TheCannon 0.5.6 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="TheCannon 0.5.6 documentation" href="index.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> TheCannon
          

          
          </a>

          
            
            
              <div class="version">
                0.5.6
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">Reference/API</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">TheCannon</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Requirements for Input</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/input_requirements.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="requirements-for-input">
<span id="input-requirements"></span><h1>Requirements for Input<a class="headerlink" href="#requirements-for-input" title="Permalink to this headline">Â¶</a></h1>
<p>As mentioned in the previous section,
the most difficult part of using <em>The Cannon</em>
is getting your data into a suitable format.
For a detailed description of the requirements,
you are encouraged to read  <a class="reference external" href="http://arxiv.org/abs/1501.07604">Ness et al. 2015</a>.
Here are some basics:</p>
<blockquote>
<div><ul class="simple">
<li>All spectra must come from the same dataset
(same telescope, same reduction pipeline)</li>
<li>Reference labels (the high-fidelity labels you use for the training set)
must come from a consistent source. To be more concrete:
imagine that you want to measure Teff and logg,
and you think that the most reliable Teff comes from APOGEE,
while the most reliable logg comes from Kepler.
Then <em>all</em> of your reference Teff values must come from the same APOGEE
dataset, and <em>all</em> of your reference logg values must come from the same
Kepler dataset.</li>
<li>Spectra must be normalized in a consistent way that is independent of
signal-to-noise (more precisely:
the normalization procedure should be a linear operation on the data,
so that it is unbiased as (symmetric) noise grows)</li>
<li>Spectra must be radial velocity shifted (so, spectral features
should line up at the same wavelength values when two objects are compared)</li>
<li>Spectra must be sampled onto a common wavelength grid
(all spectra must have the same start and stop wavelengths,
and the same wavelength values)</li>
<li>Spectra must have a common line-spread function
(cannot have different resolution)</li>
<li>Each flux value in the spectrum must be accompanied by an error bar
(or an inverse variance)</li>
<li>A bad datapoint must be assigned an inverse variance of zero
or very close to zero.
<code class="docutils literal"><span class="pre">Bad</span> <span class="pre">Data</span></code> includes regions where there are many skylines,
regions where sky subtraction is known to be an issue,
and telluric regions.</li>
</ul>
</div></blockquote>
<p>The spirit behind all of this is that the model you build with <em>The Cannon</em>,
and which you ultimately use to fit all of the spectra,
only knows about the labels and the symmetric (Gaussian) noise (S/N).
It does not know about any other effects,
such as those resulting from artifacts of using two different telescopes.
The model does not know about all of the factors that go into the overall
shape of a spectrum, nor does it know about line broadening due to rotation,
nor the shifting of lines due to a nonzero radial velocity.
It also doesn&#8217;t know about bad data or skylines &#8211; it will simply weight
every pixel in the spectrum using its associated formal uncertainty.</p>
<p>When you are sure that your data obey all of the above criteria,
you need to create six different Python <code class="docutils literal"><span class="pre">numpy</span></code> arrays.
They are described below, together with the required shape.</p>
<p>In case you&#8217;re new to Python, here&#8217;s a quick note on how to check the shape
of a numpy array called <code class="docutils literal"><span class="pre">my_array</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">my_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
<p>That 1-D array has a shape (length) of 5.
It is the same for a 2-D array:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">my_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],[</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">my_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
<p>That 2-D array is a shape (2,5): 2 rows, 5 columns.</p>
<p>Now that you know how to check the shapes of your arrays,
here is what you need:</p>
<ol class="arabic">
<li><p class="first"><strong>Wavelength Grid</strong></p>
<blockquote>
<div><ul>
<li><p class="first">This is a 1-D array of wavelength values with length [num_pixels].
This is the wavelength grid for all of the spectra in your dataset.
It will look something like</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">my_wavelength_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3600</span><span class="p">,</span> <span class="mi">3605</span><span class="p">,</span> <span class="mi">3610</span><span class="p">,</span> <span class="mi">3615</span><span class="p">,</span> <span class="o">...</span><span class="p">])</span>
</pre></div>
</div>
<p>where each value is the wavelength in Angstroms
(or whatever unit you would like).
To make this more concrete, if the number of pixels in your spectrum
is 10,000, then running</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">my_wavelength_grid</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
<p>should print (10000).
(You can name the array whatever you want; this is just an example.)</p>
</li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><strong>Flux Values of Training Spectra</strong></p>
<blockquote>
<div><ul class="simple">
<li>This is a 2-D array of flux (pixel intensity) values with the shape
[num_training_objects x num_pixels]</li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><strong>Uncertainties in Flux Values of Training Spectra</strong></p>
<blockquote>
<div><ul class="simple">
<li>This is a 2-D array of inverse variance values with an identical
shape to the training spectra:
[num_training objects x num_pixels].</li>
<li>The objects must be in the same order as in the Training Spectra array.
That is, if Object A has its spectrum in Row 10
of the training spectra array, then it should have its uncertainties
in Row 10 of the uncertainties array.</li>
<li>Each inverse variance encodes the uncertainty on the corresponding flux
value in the training spectra.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><strong>Training Labels</strong></p>
<blockquote>
<div><ul class="simple">
<li>This is a 2-D array of reference (high-fidelity) labels with shape
[num_training_objects x num_labels]</li>
<li>Again, the row order must correspond to the row order
in the training spectra arrays.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><strong>Flux Values of Test Spectra</strong></p>
<blockquote>
<div><ul class="simple">
<li>Same as (2), except these are the objects you want to measure labels for,
not the ones you have labels for already. So the shape should be
[num_test_objects x num_pixels]</li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><strong>Uncertainties in Flux Values of Test Specra</strong></p>
<blockquote>
<div><ul class="simple">
<li>Same as (3), except these correspond to the flux values in (5).</li>
</ul>
</div></blockquote>
</li>
</ol>
<p>Phew! Once you have all of those spectra in hand,
and they meet the requirements listed above,
you are ready to use <em>The Cannon</em>.</p>
</div>


           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Anna Ho.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.5.6',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>